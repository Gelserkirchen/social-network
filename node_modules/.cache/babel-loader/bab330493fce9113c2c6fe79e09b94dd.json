{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from'../../api/api';import{updateObjectInArray}from'../../components/Utils/objectHelper';var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_TOTAL_COUNT_OF_USERS='SET_TOTAL_COUNT_OF_USERS';var TOGGLE_FETCHING_STATUS='TOGGLE_FETCHING_STATUS';var TOGGLE_BUTTON_STATUS='TOGGLE_BUTTON_STATUS';var initialState={usersData:[],usersOnPage:5,countOfUsers:19,currentPageNumber:1,isFetching:false,buttonsDisabledArray:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{usersData:updateObjectInArray(state.usersData,action.userId,\"id\",{followType:true})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{usersData:updateObjectInArray(state.usersData,action.userId,\"id\",{followType:false})});case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{usersData:action.users});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPageNumber:action.pageNumber});}case SET_TOTAL_COUNT_OF_USERS:{return _objectSpread(_objectSpread({},state),{},{countOfUsers:action.countOfUsers});}case TOGGLE_FETCHING_STATUS:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case TOGGLE_BUTTON_STATUS:{// debugger\nreturn _objectSpread(_objectSpread({},state),{},{buttonsDisabledArray:action.isFetching?[].concat(_toConsumableArray(state.buttonsDisabledArray),[action.userId]):[state.buttonsDisabledArray.filter(function(id){return id!==action.userId;})]});}default:return state;}};export var followAction=function followAction(userId){return{type:FOLLOW,userId:userId};};export var unfollowAction=function unfollowAction(userId){return{type:UNFOLLOW,userId:userId};};export var setUsersAction=function setUsersAction(users){return{type:SET_USERS,users:users};};export var setCurrentPageAction=function setCurrentPageAction(pageNumber){return{type:SET_CURRENT_PAGE,pageNumber:pageNumber};};export var setTotalCountOfUsers=function setTotalCountOfUsers(countOfUsers){return{type:SET_TOTAL_COUNT_OF_USERS,countOfUsers:countOfUsers};};export var toggleFetchingStatus=function toggleFetchingStatus(isFetching){return{type:TOGGLE_FETCHING_STATUS,isFetching:isFetching};};export var toggleButtonStatus=function toggleButtonStatus(isFetching,userId){return{type:TOGGLE_BUTTON_STATUS,isFetching:isFetching,userId:userId};};export default usersReducer;export var getUsers=function getUsers(){var pageNumber=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState.currentPageNumber;return function(dispatch){dispatch(setCurrentPageAction(pageNumber));dispatch(toggleButtonStatus(true));usersAPI.getUsers(pageNumber,initialState.usersOnPage).then(function(response){dispatch(toggleFetchingStatus(false));dispatch(setUsersAction(response.items));if(pageNumber===initialState.currentPageNumber){dispatch(setTotalCountOfUsers(response.totalCount));}});};};var toggleFollowStatus=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userId,dispatch,apiUsersMethod,actionMethod){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleButtonStatus(true,userId));_context.next=3;return apiUsersMethod(userId);case 3:response=_context.sent;if(response.resultCode===0){dispatch(actionMethod(userId));}dispatch(toggleButtonStatus(false,userId));case 6:case\"end\":return _context.stop();}}},_callee);}));return function toggleFollowStatus(_x,_x2,_x3,_x4){return _ref.apply(this,arguments);};}();export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return toggleFollowStatus(userId,dispatch,usersAPI.getUsersForUnfollow.bind(usersAPI),unfollowAction);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x5){return _ref2.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return toggleFollowStatus(userId,dispatch,usersAPI.getUsersForFollow.bind(usersAPI),followAction);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x6){return _ref3.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/src/redux/reducers/usersReducer.js"],"names":["usersAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_COUNT_OF_USERS","TOGGLE_FETCHING_STATUS","TOGGLE_BUTTON_STATUS","initialState","usersData","usersOnPage","countOfUsers","currentPageNumber","isFetching","buttonsDisabledArray","usersReducer","state","action","type","userId","followType","users","pageNumber","filter","id","followAction","unfollowAction","setUsersAction","setCurrentPageAction","setTotalCountOfUsers","toggleFetchingStatus","toggleButtonStatus","getUsers","dispatch","then","response","items","totalCount","toggleFollowStatus","apiUsersMethod","actionMethod","resultCode","unfollow","getUsersForUnfollow","bind","follow","getUsersForFollow"],"mappings":"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","sourcesContent":["import { usersAPI } from '../../api/api'\nimport {updateObjectInArray} from '../../components/Utils/objectHelper';\n\nconst FOLLOW = 'FOLLOW'\nconst UNFOLLOW = 'UNFOLLOW'\nconst SET_USERS = 'SET_USERS'\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE'\nconst SET_TOTAL_COUNT_OF_USERS = 'SET_TOTAL_COUNT_OF_USERS'\nconst TOGGLE_FETCHING_STATUS = 'TOGGLE_FETCHING_STATUS'\nconst TOGGLE_BUTTON_STATUS = 'TOGGLE_BUTTON_STATUS'\n\nconst initialState = {\n  usersData: [],\n  usersOnPage: 5,\n  countOfUsers: 19,\n  currentPageNumber: 1,\n  isFetching: false,\n  buttonsDisabledArray: []\n}\n\nconst usersReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case FOLLOW:\n      return {\n        ...state,\n        usersData: updateObjectInArray(state.usersData, action.userId, \"id\", {followType: true})\n      }\n    case UNFOLLOW:\n      return {\n        ...state,\n        usersData: updateObjectInArray(state.usersData, action.userId, \"id\", {followType: false})\n      }\n    case SET_USERS: {\n      return {...state, usersData: action.users}\n    }\n    case SET_CURRENT_PAGE: {\n      return {...state, currentPageNumber: action.pageNumber}\n    }\n    case SET_TOTAL_COUNT_OF_USERS: {\n      return {...state, countOfUsers: action.countOfUsers}\n    }\n    case TOGGLE_FETCHING_STATUS: {\n      return {...state, isFetching: action.isFetching}\n    }\n    case TOGGLE_BUTTON_STATUS: {\n      // debugger\n      return {\n        ...state, \n        buttonsDisabledArray: action.isFetching ? \n        [...state.buttonsDisabledArray, action.userId] :\n        [state.buttonsDisabledArray.filter(id => id !== action.userId)]\n      }\n    }\n\n    default:\n      return state\n  }\n}\n\nexport const followAction = (userId) => ({type: FOLLOW, userId})\nexport const unfollowAction = (userId) => ({type: UNFOLLOW, userId})\nexport const setUsersAction = (users) => ({type: SET_USERS, users})\nexport const setCurrentPageAction = (pageNumber) => ({type: SET_CURRENT_PAGE, pageNumber})\nexport const setTotalCountOfUsers = (countOfUsers) => ({type: SET_TOTAL_COUNT_OF_USERS, countOfUsers})\nexport const toggleFetchingStatus = (isFetching) => ({type: TOGGLE_FETCHING_STATUS, isFetching})\nexport const toggleButtonStatus = (isFetching, userId) => ({type: TOGGLE_BUTTON_STATUS, isFetching, userId})\n\nexport default usersReducer\n\nexport const getUsers = (pageNumber = initialState.currentPageNumber) => {\n   return (dispatch) => {\n      \n      dispatch(setCurrentPageAction(pageNumber))\n      dispatch(toggleButtonStatus(true))\n\n      usersAPI.getUsers(pageNumber, initialState.usersOnPage).then(response => {\n        dispatch(toggleFetchingStatus(false))\n        dispatch(setUsersAction(response.items))\n\n        if (pageNumber === initialState.currentPageNumber) {\n           dispatch(setTotalCountOfUsers(response.totalCount))\n        }\n    })\n   }\n}\n\nconst toggleFollowStatus = async (userId, dispatch, apiUsersMethod, actionMethod) => {\n  dispatch(toggleButtonStatus(true, userId))\n  const response = await apiUsersMethod(userId)\n  if (response.resultCode === 0) {\n    dispatch(actionMethod(userId))\n  }\n  dispatch(toggleButtonStatus(false, userId))\n}\n\nexport const unfollow = (userId) => {\n  return async (dispatch) => {\n    await toggleFollowStatus(userId, dispatch, usersAPI.getUsersForUnfollow.bind(usersAPI), unfollowAction)\n  }\n}\n\nexport const follow = (userId) => {\n  return async (dispatch) => {\n    await toggleFollowStatus(userId, dispatch, usersAPI.getUsersForFollow.bind(usersAPI), followAction)\n  }\n}\n"]},"metadata":{},"sourceType":"module"}