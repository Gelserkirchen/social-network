{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{stopSubmit}from'redux-form';import{authAPI}from'../../api/api';var SET_USER_DATA='samuraiNetwork/auth/SET_USER_DATA';var initialState={id:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;// debugger\nswitch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),{},{isAuth:true},action.data);default:return state;}};export default authReducer;export var setAuthUserData=function setAuthUserData(id,login,email,isAuth){return{type:SET_USER_DATA,data:{id:id,login:login,email:email,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.me();case 2:response=_context.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(response.data.data.id,response.data.data.login,response.data.data.email,true));}else{dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,nameOfError;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}else{nameOfError=response.data.messages.length>0?response.data.messages[0]:\"some error\";dispatch(stopSubmit('login',{_error:nameOfError}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/tolstyhandrejaleksandrovic/Documents/GitHub/social-network/src/redux/reducers/authReducer.js"],"names":["stopSubmit","authAPI","SET_USER_DATA","initialState","id","email","login","isAuth","authReducer","state","action","type","data","setAuthUserData","getAuthUserData","dispatch","me","response","resultCode","password","rememberMe","nameOfError","messages","length","_error","logout"],"mappings":"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","sourcesContent":["import { stopSubmit } from 'redux-form'\nimport { authAPI } from '../../api/api'\n\nconst SET_USER_DATA = 'samuraiNetwork/auth/SET_USER_DATA'\n\nconst initialState = {\n    id: null,\n    email: null,\n    login: null,\n    isAuth: false\n}\n\nconst authReducer = (state = initialState, action) => {\n    // debugger\n    switch (action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state,\n                isAuth: true,\n                ...action.data,\n            }\n        default:\n            return state\n    }\n}\n\nexport default authReducer\n\nexport const setAuthUserData = (id, login, email, isAuth) => ({\n    type: SET_USER_DATA,\n    data: {id, login, email, isAuth}    \n}) \n\nexport const getAuthUserData = () => {\n    return async (dispatch) => {\n        let response = await authAPI.me();\n\n        if (response.data.resultCode === 0) {\n                dispatch(setAuthUserData(\n                    response.data.data.id, \n                    response.data.data.login, \n                    response.data.data.email,\n                    true,\n                    ))\n        } else {\n                dispatch(setAuthUserData(null, null, null, false))\n        }\n    }\n}\n\nexport const login = (email, password, rememberMe) => {\n    return async (dispatch) => {\n        let response = await authAPI.login(email, password, rememberMe);\n        if (response.data.resultCode === 0) {\n            dispatch(getAuthUserData())\n        } else {\n            let nameOfError = response.data.messages.length > 0 ? response.data.messages[0] : \"some error\"\n            dispatch(stopSubmit('login', {_error: nameOfError}))\n        }\n    }\n}\n\nexport const logout = () => {\n    return async (dispatch) => {\n        let response = await authAPI.logout();\n\n        if (response.data.resultCode === 0) {\n            dispatch(getAuthUserData())\n        }\n\n    }\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}